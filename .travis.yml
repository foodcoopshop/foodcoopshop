language: php
 
php:
  - 7.1

services:
  - mysql

env:
  - DB=mysql
  
before_script:
  - git clone --depth 1 git://github.com/foodcoopshop/foodcoopshop
  - mysql -e 'CREATE DATABASE foodcoopshop_test;'
  - mysql foodcoopshop_test < ./Test/test_files/Config/sql/test-db-structure.sql
  - mysql foodcoopshop_test < ./Test/test_files/Config/sql/test-db-data.sql
  - composer install --prefer-dist
  - cp ./Config/travis/* ./Config/
  # Apache Install
  - git clone https://github.com/lucatume/travis-apache-setup.git setup
  - sudo sh ./setup/apache-setup -h="127.0.0.1" -u="http://www.foodcoopshop.dev" -f="/var/www/foodcoopshop/webroot"

script:
  - ./Console/cake test Controller/CartsController.php --stderr
  
notifications:
  email: false
  