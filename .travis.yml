language: php
 
php:
  - 5.5
  - 5.6
  - 7.0
  - 7.1

services:
  - mysql

env:
  - DB=mysql
  
before_install:
  - mysql -e 'CREATE DATABASE foodcoopshop_test;'
  
before_script:
  - git clone --depth 1 git://github.com/foodcoopshop/foodcoopshop
  - composer install --prefer-dist
  - mv ./Config/credentials.default.php ./Config/credentials.php
  - echo "<?php
    class DATABASE_CONFIG {
        public \$test = array(
            'datasource' => 'Database/Mysql',
            'persistent' => false,
            'database' => 'foodcoopshop_test',
            'host' => '127.0.0.1',
            'login' => 'travis',
            'encoding' => 'utf8'
        );
    }" > ./Config/database.php
 
script:
  - ./Console/cake test Controller/Component/StringComponentTest.php --stderr
  
notifications:
  email: false
  